<div class="min-h-screen bg-white relative overflow-hidden">
  <!-- Background Gradient -->
  <div class="absolute inset-0 bg-gradient-pink" data-loc="class _App"></div>
  
  <!-- Decorative Background Elements -->
  <div class="absolute inset-0 pointer-events-none flex flex-col justify-start items-start" data-loc="class _App">
     <svg data-loc="class _App" class="absolute bottom-0 left-0 w-full h-full opacity-80 animate-float" style="transform: translateY(24rem);" viewBox="0 0 1440 1024" fill="none" xmlns="http://www.w3.org/2000/svg">
      <g opacity="0.8">
        <g filter="url(#filter0_f)">
          <path opacity="0.65" d="M1440 1130.77V900.73C1440 566.61 1169.14 295.752 835.022 295.752H604.978C270.858 295.752 0 566.61 0 900.73V1130.77C0 1464.89 270.858 1735.75 604.978 1735.75H835.022C1169.14 1735.75 1440 1464.89 1440 1130.77Z" fill="#E849F2"/>
        </g>
        <g filter="url(#filter1_f)">
          <path opacity="0.65" d="M1425.52 1118.21V917.494C1425.52 583.374 1154.66 312.517 820.539 312.517H621.511C287.391 312.517 16.5337 583.374 16.5337 917.494V1118.21C16.5337 1452.33 287.391 1723.19 621.511 1723.19H820.539C1154.66 1723.19 1425.52 1452.33 1425.52 1118.21Z" fill="#F37EF8"/>
        </g>
        <g filter="url(#filter2_f)">
          <path d="M1366.73 1031.61V1004.09C1366.73 669.969 1095.87 399.112 761.748 399.112H680.135C346.015 399.112 75.1569 669.969 75.1569 1004.09V1031.61C75.1569 1365.73 346.015 1636.59 680.135 1636.59H761.748C1095.87 1636.59 1366.73 1365.73 1366.73 1031.61Z" fill="#FBECFA"/>
          <path opacity="0.65" d="M1333.5 1026.04V1009.68C1333.5 675.562 1062.64 404.703 728.517 404.703H713.366C379.246 404.703 108.388 675.562 108.388 1009.68V1026.04C108.388 1360.16 379.246 1631.01 713.366 1631.01H728.517C1062.64 1631.01 1333.5 1360.16 1333.5 1026.04Z" fill="#FF7EEA"/>
        </g>
      </g>
      <defs>
        <filter id="filter0_f" x="-295.1" y="0.651794" width="2030.2" height="2030.2" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
          <feFlood flood-opacity="0" result="BackgroundImageFix"/>
          <feBlend mode="normal" in="SourceGraphic" in2="BackgroundImageFix" result="shape"/>
          <feGaussianBlur stdDeviation="147.55" result="effect1_foregroundBlur"/>
        </filter>
        <filter id="filter1_f" x="-109.938" y="186.045" width="1661.93" height="1663.61" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
          <feFlood flood-opacity="0" result="BackgroundImageFix"/>
          <feBlend mode="normal" in="SourceGraphic" in2="BackgroundImageFix" result="shape"/>
          <feGaussianBlur stdDeviation="63.2357" result="effect1_foregroundBlur"/>
        </filter>
        <filter id="filter2_f" x="-47.099" y="276.856" width="1536.08" height="1481.99" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
          <feFlood flood-opacity="0" result="BackgroundImageFix"/>
          <feBlend mode="normal" in="SourceGraphic" in2="BackgroundImageFix" result="shape"/>
          <feGaussianBlur stdDeviation="61.1279" result="effect1_foregroundBlur"/>
        </filter>
      </defs>
    </svg>
  </div>

  <!-- Main Layout -->
  <div class="relative z-10 flex h-screen flex-col lg:flex-row" style="gap: 1rem;">
    <!-- Left Sidebar -->
    <div class="flex flex-col p-3 gap-2.5 lg:h-auto h-auto lg:border-r-0 border-b border-gray-200 transition-all duration-300 overflow-hidden" 
         [class.lg:w-72]="isLeftPanelExpanded()" 
         [class.lg:w-16]="!isLeftPanelExpanded()"
         [class.w-full]="isLeftPanelExpanded()"
         [class.w-16]="!isLeftPanelExpanded()">
      <!-- Header Icons -->
      <div class="flex justify-between items-center px-2">
        <!-- Square icon with plus - only visible when collapsed (New Task collapsed) -->
        <button class="w-8 h-8 bg-gray-100 hover:bg-gray-200 rounded flex items-center justify-center transition-all duration-300" 
                [class.hidden]="isLeftPanelExpanded()" 
                (click)="createNewTask()">
          <svg class="w-4 h-4 text-gray-600" viewBox="0 0 24 24" fill="none">
            <path d="M12 5V19M5 12H19" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>
        
        <!-- Square icon - toggle button when expanded -->
        <button class="w-6 h-6 text-text-neutral hover:bg-gray-100 rounded p-1 transition-colors" 
                [class.hidden]="!isLeftPanelExpanded()"
                (click)="toggleLeftPanel()">
          <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none">
            <path d="M16.5 16V8L12.5 12L16.5 16ZM5 21C4.45 21 3.97917 20.8042 3.5875 20.4125C3.19583 20.0208 3 19.55 3 19V5C3 4.45 3.19583 3.97917 3.5875 3.5875C3.97917 3.19583 4.45 3 5 3H19C19.55 3 20.0208 3.19583 20.4125 3.5875C20.8042 3.97917 21 4.45 21 5V19C21 19.55 20.8042 20.0208 20.4125 20.4125C20.0208 20.8042 19.55 21 19 21H5ZM8 19V5H5V19H8ZM10 19H19V5H10V19Z" fill="currentColor"/>
          </svg>
        </button>
        
        <div class="flex items-center gap-2">
          <!-- Search icon - only visible when expanded -->
          <svg class="w-6 h-6 text-text-neutral transition-all duration-300" 
               [class.hidden]="!isLeftPanelExpanded()"
               viewBox="0 0 24 24" fill="none">
            <path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z" fill="currentColor"/>
          </svg>
          
          <!-- Expand button - only visible when collapsed -->
          <button class="w-6 h-6 text-text-neutral hover:bg-gray-100 rounded p-1 transition-colors" 
                  [class.hidden]="isLeftPanelExpanded()"
                  (click)="toggleLeftPanel()">
            <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none">
              <path d="M9 18L15 12L9 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </button>
        </div>
      </div>

      <!-- New Task Button -->
      <button class="flex items-center justify-center h-9 px-4 bg-primary text-white rounded-6 font-roboto text-sm font-medium transition-all duration-300" 
              [class.hidden]="!isLeftPanelExpanded()">
        New Task
      </button>

      <!-- Today Section -->
      <div class="font-inter text-sm font-semibold text-text-neutral px-2 mt-2 transition-all duration-300" 
           [class.hidden]="!isLeftPanelExpanded()">
        Today
      </div>

      <!-- Task Item -->
      <div class="flex items-center gap-2 p-2 bg-white rounded-16 w-full lg:max-w-xs transition-all duration-300" 
           [class.hidden]="!isLeftPanelExpanded()">
        <div class="w-8 h-8 rounded-16 bg-primary border-2 border-white shadow-lg flex items-center justify-center">
          <svg class="w-4 h-4 text-white" viewBox="0 0 16 16" fill="none">
            <path d="M12.6667 3.33333V12.6667H3.33333V3.33333H12.6667ZM12.6667 2H3.33333C2.6 2 2 2.6 2 3.33333V12.6667C2 13.4 2.6 14 3.33333 14H12.6667C13.4 14 14 13.4 14 12.6667V3.33333C14 2.6 13.4 2 12.6667 2Z" fill="currentColor"/>
            <path d="M9.33333 11.3333H4.66667V10H9.33333V11.3333ZM11.3333 8.66667H4.66667V7.33333H11.3333V8.66667ZM11.3333 6H4.66667V4.66667H11.3333V6Z" fill="currentColor"/>
          </svg>
        </div>
        <div class="flex-1">
          <div class="font-inter text-sm font-semibold text-black">Imp</div>
          <div class="font-roboto text-xs text-text-neutral leading-4">I have</div>
        </div>
      </div>
    </div>

    <!-- Main Content Area -->
    <div class="flex-1 flex flex-col p-6" style="border-radius: var(--Base-Values-40, 1.5rem) var(--Base-Values-40, 1.5rem) 0 0; background: linear-gradient(180deg, #FFF 0%, rgba(255, 255, 255, 0.00) 137.24%); margin-top: 0.75rem; margin-right: 0.75rem;">
      <!-- Email Content and Right Panel -->
        <div class="flex-1 flex gap-8">
        <!-- Email Content -->
        <div class="flex-1 flex flex-col">
          <div class="flex items-start gap-2 mb-6">
            <div class="w-10 h-10 rounded-16 bg-blue-600/60 border-2 border-white shadow-lg"></div>
            <div class="flex-1 bg-gradient-to-r from-pink-100 to-pink-50 p-4 rounded-tr-16 rounded-b-16 rounded-tl-4" style="background: #FBECFA;">
              <div class="font-roboto text-base text-black leading-5">
                Subject: Update on Payment Status for Reference dc80719f-3161-4204-a14b-8a733420bf5f<br><br>
                Dear Sushil,<br><br>
                Thank you for reaching out regarding the status of your payment with reference dc80719f-3161-4204-a14b-8a733420bf5f.<br><br>
                We have reviewed the transaction and found that the payment is currently pending due to an issue encountered during the funds control process. Although the payment was successfully initiated and cleared all compliance checks, it did not pass the internal funds control phase. As a result, the payment has not yet been completed and is under technical review by our team.<br><br>
                Please be assured that we are actively investigating the matter to resolve the issue as quickly as possible. We will keep you updated on any progress or if further information is required.<br><br>
                Thank you for your patience and understanding. If you have any further questions or need additional assistance, please let us know.<br><br>
                Best regards, Client Servicing Team
              </div>
            </div>
          </div>

          <!-- Input Area -->
          <div class="mt-auto">
            <div class="bg-white/80 backdrop-blur-75 border border-stroke-neutral-light rounded-24 p-4 lg:p-6 shadow-inner-custom cursor-text" style="box-shadow: 0 0 121.981px 2.44px #FFF inset;" (click)="focusInput()">
              <div class="flex justify-between items-center">
                <button class="w-8 h-8 bg-surface-primary-light border border-gray-200 rounded-full flex items-center justify-center shadow-sm" (click)="addAttachment($event)">
                  <svg class="w-5 h-5 text-primary" viewBox="0 0 20 20" fill="none">
                    <path d="M15.8334 10.8333H10.8334V15.8333H9.16675V10.8333H4.16675V9.16663H9.16675V4.16663H10.8334V9.16663H15.8334V10.8333Z" fill="currentColor"/>
                  </svg>
                </button>
                <input 
                  #messageInput
                  type="text" 
                  [(ngModel)]="newMessage"
                  (keypress)="onMessageKeyPress($event)"
                  placeholder="Ask Pete"
                  class="flex-1 h-8 bg-transparent border-none outline-none px-3 text-sm placeholder-gray-500">
                <button 
                  class="w-8 h-8 bg-primary rounded-50 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed" 
                  (click)="sendMessage($event)"
                  [disabled]="!newMessage?.trim()">
                  <svg class="w-5 h-5 text-white" viewBox="0 0 20 20" fill="none">
                    <path d="M3.33325 10L4.50825 11.175L9.16658 6.52504V16.6667H10.8333V6.52504L15.4833 11.1834L16.6666 10L9.99992 3.33337L3.33325 10Z" fill="currentColor"/>
                  </svg>
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- Right Panel - Sentiment and Tasks -->
        <div class="w-[27.5rem] space-y-6">
          <!-- Sentiment Card -->
           <div class="bg-gradient-success rounded-16 w-full overflow-hidden">
             <!-- Green rectangle at top -->
             <div class="w-full h-1 bg-success-300"></div>
             <!-- Content with padding -->
             <div class="p-4">
               <div class="font-roboto text-lg font-semibold text-black mb-3">Sentiment</div>
               <div class="flex items-center gap-5">
                 <div class="w-15 h-15 bg-success-400 rounded-full flex items-center justify-center relative" style="width: 60px; height: 60px;">
                   <!-- Smiley Face -->
                   <svg width="32" height="32" viewBox="0 0 60 60" fill="none">
                     <circle cx="30" cy="30" r="30" fill="#01A577"/>
                     <path d="M14 34C15.5144 37.9561 19.7284 46 30 46C40.2716 46 45.4074 37.9561 46 34" stroke="white" stroke-width="4" stroke-linecap="round"/>
                   </svg>
                 </div>
                 <div class="flex-1 font-roboto text-base text-black">
                   The email tone is polite but you can sense the frustration behind the multiple follow-ups!
                 </div>
               </div>
             </div>
           </div>

          <!-- Task Progress Card -->
          <div class="bg-white border border-stroke-neutral-light rounded-16 p-4 w-full">
            <div class="flex items-center gap-2.5 cursor-pointer" [class.mb-5]="isTaskProgressExpanded()" (click)="toggleTaskProgress()">
              <svg class="w-6 h-6 text-text-neutral transition-transform duration-200" [class.rotate-180]="!isTaskProgressExpanded()" viewBox="0 0 24 25" fill="none">
                <path d="M12 8.79504L6 14.795L7.41 16.205L12 11.625L16.59 16.205L18 14.795L12 8.79504Z" fill="currentColor"/>
              </svg>
              <div class="flex-1 font-roboto text-lg font-semibold text-black">Task Progress</div>
              <div class="font-roboto text-base text-text-neutral">1/3</div>
            </div>

            <!-- Progress Items -->
            <div class="space-y-5 transition-all duration-300 overflow-hidden" [class.hidden]="!isTaskProgressExpanded()" [style.max-height]="isTaskProgressExpanded() ? '500px' : '0px'">
              <!-- Completed Task -->
              <div class="flex items-start gap-3">
                <div class="w-6 h-6 bg-success-400 rounded-full flex items-center justify-center">
                  <svg class="w-4 h-4 text-white" viewBox="0 0 16 16" fill="none">
                    <path d="M5.86339 10.5834L3.08339 7.80336L2.13672 8.74336L5.86339 12.47L13.8634 4.47003L12.9234 3.53003L5.86339 10.5834Z" fill="currentColor"/>
                  </svg>
                </div>
                <div class="flex-1 font-roboto text-base text-text-neutral line-through">
                  Fix animation position to appear above the button instead of top on it
                </div>
              </div>

              <!-- In Progress Task -->
              <div class="flex items-start gap-3">
                <div class="w-6 h-6 bg-primary rounded-full flex items-center justify-center">
                  <svg class="w-4 h-4 text-white" viewBox="0 0 16 16" fill="none">
                    <path d="M8.00008 2.66663L7.06008 3.60663L10.7801 7.33329H2.66675V8.66663H10.7801L7.06008 12.3933L8.00008 13.3333L13.3334 7.99996L8.00008 2.66663Z" fill="currentColor"/>
                  </svg>
                </div>
                <div class="flex-1 font-roboto text-base text-text-neutral">
                  Fix animation position to appear above the button instead of top on it
                </div>
              </div>

              <!-- Pending Task -->
              <div class="flex items-start gap-3">
                <div class="w-6 h-6 bg-white border border-stroke-neutral-light rounded-full"></div>
                <div class="flex-1 font-roboto text-base text-text-neutral">
                  Double the animation size from 100x100 to 200x200
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

  </div>
</div>
